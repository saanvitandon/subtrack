<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SubTrack ‚Äî Sign Up</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<button class="theme-toggle auth-theme-btn" id="theme-btn" title="Toggle theme">‚òÄÔ∏è</button>

<div class="auth-page">

  <div class="auth-left">
    <div class="auth-brand">
      <div class="auth-logo">Sub<span>Track</span></div>
      <div class="auth-tagline">Your subscriptions, organised.</div>
    </div>
    <div class="auth-features">
      <div class="auth-feature">
        <span class="auth-feature-icon">‚óà</span>
        <span>Dashboard for all your services</span>
      </div>
      <div class="auth-feature">
        <span class="auth-feature-icon">‚óé</span>
        <span>Monthly & yearly spend analytics</span>
      </div>
      <div class="auth-feature">
        <span class="auth-feature-icon">‚ú¶</span>
        <span>100% private ‚Äî no servers, no tracking</span>
      </div>
    </div>
  </div>

  <div class="auth-right">
    <div class="auth-card">

      <div class="auth-card-header">
        <h1 class="auth-title">Create account</h1>
        <p class="auth-subtitle">Start tracking your subscriptions today</p>
      </div>

      <form id="signup-form" novalidate>

        <div class="auth-group">
          <label for="username">Username</label>
          <input id="username" type="text" placeholder="e.g. Arjun" autocomplete="username" />
        </div>

        <div class="auth-group">
          <label for="email">Email address</label>
          <input id="email" type="email" placeholder="you@example.com" autocomplete="email" />
        </div>

        <div class="auth-group">
          <label for="password">Password <span class="auth-hint">min. 6 characters</span></label>
          <div class="auth-input-wrap">
            <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" />
            <button type="button" class="auth-eye" id="toggle-pw" title="Show/hide password">üëÅ</button>
          </div>
        </div>

        <div class="auth-group">
          <label for="confirm">Confirm password</label>
          <div class="auth-input-wrap">
            <input id="confirm" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password" />
            <button type="button" class="auth-eye" id="toggle-confirm" title="Show/hide password">üëÅ</button>
          </div>
        </div>

        <div class="pw-strength-wrap">
          <div class="pw-strength-bar" id="pw-bar"></div>
        </div>
        <div class="pw-strength-label" id="pw-label"></div>

        <button class="auth-btn" type="submit">Create Account</button>

        <div class="auth-divider"><span>or</span></div>

        <button class="auth-btn-oauth google" type="button" id="google-btn">
          <svg width="18" height="18" viewBox="0 0 18 18"><path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/><path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z"/><path fill="#FBBC05" d="M3.964 10.707A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.707V4.961H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.039l3.007-2.332z"/><path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.961L3.964 6.293C4.672 4.166 6.656 3.58 9 3.58z"/></svg>
          Continue with Google
        </button>

        <button class="auth-btn-oauth github" type="button" id="github-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 21.795 24 17.298 24 12c0-6.63-5.37-12-12-12z"/></svg>
          Continue with GitHub
        </button>

      </form>

      <p class="auth-switch">Already have an account? <a href="login.html" class="auth-link">Sign in</a></p>

    </div>
  </div>
</div>

<div id="toast"></div>
<script src="auth.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  initTheme();

  if (getSession()) { window.location.href = 'index.html'; return; }

  // Password visibility toggles
  function toggleVis(inputId) {
    var el = document.getElementById(inputId);
    el.type = el.type === 'password' ? 'text' : 'password';
  }
  document.getElementById('toggle-pw').addEventListener('click', function() { toggleVis('password'); });
  document.getElementById('toggle-confirm').addEventListener('click', function() { toggleVis('confirm'); });

  // Password strength meter
  document.getElementById('password').addEventListener('input', function() {
    var val  = this.value;
    var bar  = document.getElementById('pw-bar');
    var lbl  = document.getElementById('pw-label');
    var score = 0;
    if (val.length >= 6)  score++;
    if (val.length >= 10) score++;
    if (/[A-Z]/.test(val)) score++;
    if (/[0-9]/.test(val)) score++;
    if (/[^A-Za-z0-9]/.test(val)) score++;

    var labels = ['', 'Weak', 'Fair', 'Good', 'Strong', 'Very strong'];
    var colors = ['', '#f04a7a', '#f0c84a', '#4ab0f0', '#4af0c8', '#c8f04a'];
    bar.style.width   = (score / 5 * 100) + '%';
    bar.style.background = colors[score] || 'transparent';
    lbl.textContent   = val.length ? labels[score] || 'Very strong' : '';
    lbl.style.color   = colors[score] || 'transparent';
  });

  // OAuth placeholders
  document.getElementById('google-btn').addEventListener('click', function() {
    showAuthToast('Use email/password for now.', true);
  });
  document.getElementById('github-btn').addEventListener('click', function() {
    showAuthToast('Use email/password for now.', true);
  });

  // Signup form
  document.getElementById('signup-form').addEventListener('submit', function(e) {
    e.preventDefault();
    var username = document.getElementById('username').value.trim();
    var email    = document.getElementById('email').value.trim();
    var password = document.getElementById('password').value;
    var confirm  = document.getElementById('confirm').value;

    if (password !== confirm) {
      showAuthToast('Passwords do not match.', true);
      return;
    }

    var result = signupUser(username, email, password);
    if (!result.ok) {
      showAuthToast(result.error, true);
      return;
    }

    setSession(result.user);
    showAuthToast('Account created! Welcome, ' + username + '!');
    setTimeout(function() { window.location.href = 'index.html'; }, 900);
  });
});
</script>
</body>
</html>